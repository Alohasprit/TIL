# 한국 부동산 데이터 수집 Apps Script

이 Apps Script는 공공데이터포털의 부동산 실거래가 API를 활용하여 한국 아파트의 매매, 전세, 월세 매물 및 실거래가 정보를 Google 스프레드시트에 자동으로 수집하는 도구입니다.

## 🚀 주요 기능

- **아파트 매매 데이터** 수집 및 분석
- **아파트 전세 데이터** 수집 및 분석  
- **오피스텔 매매 데이터** 수집 및 분석
- **오피스텔 전세 데이터** 수집 및 분석
- **자동 실행** (매일 지정 시간에 데이터 업데이트)
- **다양한 지역** 지원 (전국 시/도/구 단위)
- **에러 처리** 및 로깅

## 📋 사전 준비사항

### 1. 공공데이터포털 API 키 발급

1. [공공데이터포털](https://www.data.go.kr/) 회원가입 및 로그인
2. "부동산 실거래가 정보" 검색
3. 다음 API들 신청:
   - `아파트 실거래가 정보 조회`
   - `아파트 전월세 정보 조회`
   - `오피스텔 실거래가 정보 조회`
   - `오피스텔 전월세 정보 조회`
4. 승인 후 API 키 확인

### 2. Google 스프레드시트 준비

1. 새로운 Google 스프레드시트 생성
2. 확장 프로그램 > Apps Script 선택
3. 제공된 코드 복사 및 붙여넣기

## ⚙️ 설정 방법

### 1. API 키 설정

```javascript
const API_KEY = 'YOUR_API_KEY_HERE'; // 발급받은 API 키 입력
```

### 2. 지역 및 날짜 설정

```javascript
const REGION_CODE = '11110'; // 서울특별시 종로구
const DEAL_YEAR = '2024';     // 조회할 연도
const DEAL_MONTH = '12';      // 조회할 월
```

### 3. 주요 지역 코드

| 코드 | 지역 |
|------|------|
| 11110 | 서울특별시 종로구 |
| 11140 | 서울특별시 중구 |
| 11170 | 서울특별시 용산구 |
| 11200 | 서울특별시 성동구 |
| 11215 | 서울특별시 광진구 |
| 11230 | 서울특별시 동대문구 |
| 11260 | 서울특별시 중랑구 |
| 11290 | 서울특별시 성북구 |
| 11305 | 서울특별시 강북구 |
| 11320 | 서울특별시 도봉구 |
| 11350 | 서울특별시 노원구 |
| 11380 | 서울특별시 은평구 |
| 11410 | 서울특별시 서대문구 |
| 11440 | 서울특별시 마포구 |
| 11470 | 서울특별시 양천구 |
| 11500 | 서울특별시 강서구 |
| 11530 | 서울특별시 구로구 |
| 11545 | 서울특별시 금천구 |
| 11560 | 서울특별시 영등포구 |
| 11590 | 서울특별시 동작구 |
| 11620 | 서울특별시 관악구 |
| 11650 | 서울특별시 서초구 |
| 11680 | 서울특별시 강남구 |
| 11710 | 서울특별시 송파구 |
| 11740 | 서울특별시 강동구 |

## 🎯 사용법

### 1. 기본 실행

```javascript
// 모든 부동산 데이터 수집
fetchAllRealEstateData();
```

### 2. 설정 시트 생성

```javascript
// 설정 시트 생성 (지역 코드 참고용)
createConfigSheet();
```

### 3. 자동 실행 설정

```javascript
// 매일 오전 9시에 자동 실행
setupTrigger();

// 자동 실행 중지
deleteTrigger();
```

### 4. 특정 지역 데이터 수집

```javascript
// 특정 지역의 데이터만 수집
fetchDataByRegion('11680', '2024', '12'); // 강남구 2024년 12월
```

## 📊 출력 데이터 형식

### 아파트 매매 데이터
- 거래일자
- 법정동
- 아파트명
- 전용면적
- 층
- 건축년도
- 거래금액
- 거래유형

### 아파트 전세 데이터
- 거래일자
- 법정동
- 아파트명
- 전용면적
- 층
- 건축년도
- 보증금
- 월세
- 거래유형

## 🔧 주요 함수 설명

### `fetchAllRealEstateData()`
- 모든 부동산 데이터를 수집하여 스프레드시트에 저장
- 아파트 매매, 전세, 오피스텔 매매, 전세 데이터를 각각 다른 시트에 저장

### `fetchAptTradeData()`
- 아파트 매매 데이터만 수집

### `fetchAptRentData()`
- 아파트 전세 데이터만 수집

### `fetchOfficeTradeData()`
- 오피스텔 매매 데이터만 수집

### `fetchOfficeRentData()`
- 오피스텔 전세 데이터만 수집

### `setupTrigger()`
- 자동 실행 트리거 설정 (매일 오전 9시)

### `deleteTrigger()`
- 자동 실행 트리거 삭제

### `createConfigSheet()`
- 설정 및 지역 코드 참고용 시트 생성

## ⚠️ 주의사항

1. **API 사용량 제한**: 공공데이터포털 API는 일일 사용량 제한이 있습니다.
2. **실행 시간**: Apps Script는 최대 6분 실행 제한이 있습니다.
3. **데이터 지연**: 공공데이터는 실제 거래 후 1-2개월 후에 공개됩니다.
4. **지역 코드**: 정확한 지역 코드를 사용해야 합니다.

## 🐛 문제 해결

### API 오류 발생 시
1. API 키가 올바른지 확인
2. 지역 코드가 정확한지 확인
3. 조회 날짜가 유효한지 확인

### 데이터가 없는 경우
1. 해당 지역에 거래 데이터가 없을 수 있음
2. 조회 날짜를 변경해보기
3. 다른 지역으로 테스트해보기

### 실행 시간 초과
1. 데이터 양이 많을 경우
2. 지역을 나누어서 실행
3. 월별로 나누어서 실행

## 📞 지원

문제가 발생하거나 개선 사항이 있으시면 이슈를 등록해주세요.

## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

